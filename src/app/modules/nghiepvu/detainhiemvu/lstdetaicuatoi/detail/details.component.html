
<div
    *ngIf="actionType == 'THEMMOI' || actionType == 'CHINHSUA' "
    class="flex flex-col flex-auto overflow-y-auto bg-card dark:bg-default content-detail p-3"

    [formGroup]="form" novalidate
>
    <div class="">
        <h1 class="title-component">THÔNG TIN ĐỀ TÀI, NHIỆM VỤ</h1>
        <div class="title-section">
            <i class="fa fa-minus-circle"></i> Thông tin đề tài:
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-1/2">
            <label for="">Tên đề tài, nhiệm vụ KHCN<span>(*)</span></label>
            <input
                type="text"
                placeholder="Nhập tên đề tài"
                class="form-control"
                name=""
                id=""
                formControlName="tenDeTai"
            />
        </div>
        <div class="basis-1/2">
            <label for="">Căn cứ thực hiện (từ bản định hướng)</label>
            <div class="select-cbkh flex items-center form-control">
                <input class="inputselect" type="text" name="" id=""  formControlName="canCuThucHien" />
                <i (click)="openAlertDialog('KEHOACH')" class="fa fa-search"></i>
            </div>
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-1/4">
            <label for="">Cấp quản lý<span>(*)</span></label>
            <ng-select
                [items]="listCapQuanLy"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Cấp quản lý"
                formControlName="capQuanLy" 
            >
            </ng-select>
        </div>
        <div class="basis-1/4">
            <label for="">Văn bản chỉ đạo số</label>
            <input
                class="form-control"
                placeholder="Nhập văn bản chỉ đạo số..."
                type="text"
                name=""
                formControlName="vanBanChiDaoSo" 
                id=""
            />
        </div>
        <div class="basis-1/2">
            <label for="">Lĩnh vực nghiên cứu</label>
            <ng-select [items]="listLinhVucNghienCuu" bindLabel="NAME" bindValue="ID" placeholder="Lĩnh vực nghiên cứu" [multiple]="true"
            formControlName="linhVucNghienCuu" >
        </ng-select>
        </div>
        <!-- <div class="basis-1/4">
            <ng-select [items]="listLinhVucNghienCuu" bindLabel="NAME" bindValue="ID" placeholder="Chọn năm" [multiple]="true"
            formControlName="linhVucNghienCuu" >
        </ng-select>
            <div class="list_check">
                <div class="item_list_check">
                    <input type="checkbox" name="" id="" />
                    <span>Thủy điện</span>
                </div>
                <div class="item_list_check">
                    <input type="checkbox" name="" id="" />
                    <span>Công nghệ thông tin</span>
                </div>
            </div> 
        </div> -->
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-1/4">
            <label for="">Đơn vị chủ trì<span>(*)</span></label>
            <ng-select
                [items]="listDonViChuTri"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn đơn vị chủ trì"
                formControlName="donViChuTri" 
            >
            </ng-select>
        </div>
        <div class="basis-1/4"></div>
        <div class="basis-1/4"></div>
        <div class="basis-1/4"></div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-1/4 flex justify-between items-center">
            <label for="">Thời gian thực hiện từ<span>(*)</span></label>
            <label style="margin-right: 10px">Từ</label>
        </div>
        <div class="basis-3/4 flex date-customt">
            <input class="form-control" type="date" name="" id="" formControlName="thoiGianThucHienTu"  />
            <label class="dem-pading">đến</label>
            <input class="form-control" type="date" name="" id="" formControlName="thoiGianThucHienDen" />
        </div>
    </div>

    <div class="flex flex-row row gap-4">
        <div class="basis-1/4">
            <label for="">Chủ nhiệm đề tài<span>(*)</span></label>
            <div class="select-cbkh flex items-center form-control">
                <input class="inputselect" type="text" name="" id=""  formControlName="chuNhiemDeTai"  />
                <i (click)="openAlertDialog('CHUNHIEM')" class="fa fa-search"></i>
            </div>
        </div>
        <div class="basis-1/12">
            <label for="">Giới tính</label>
            <ng-select
                [items]="listGioiTinh"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn giới tính"
                formControlName="gioiTinh" 
            >
            </ng-select>
        </div>
        <div class="basis-2/12">
            <label for="">Học hàm</label>
            <ng-select
                [items]="listHocHam"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn học hàm"
                formControlName="hocHam" 
            >
            </ng-select>
        </div>
        <div class="basis-1/4">
            <label for="">Học vị</label> 
            <ng-select
                [items]="listHocVi"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn học vị"
                formControlName="hocVi" 
            >
            </ng-select>
        </div>
        <div class="basis-1/4">
            <label for="">Đơn vị công tác</label>
            <input   class="form-control" type="text" name="" id=""  formControlName="donViCongTac"  />
            <!-- <ng-select
                [items]="listDonViCongTac"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn đơn vị"
                formControlName="donViCongTac" 
            >
            </ng-select> -->
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-1/4">
            <label for="">Đồng chủ nhiệm đề tài<span>(*)</span></label>
            <div class="select-cbkh flex items-center form-control">
                <input class="inputselect" type="text" name="" id="" formControlName="dongChuNhiemDeTai" />
                <i (click)="openAlertDialog('DONGCHUNHIEM')" class="fa fa-search"></i>
            </div>
        </div>
        <div class="basis-1/12">
            <label for="">Giới tính</label>
            <ng-select
                [items]="listGioiTinh"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn giới tính"
                formControlName="gioiTinhDongChuNhiem" 
            >
            </ng-select>
        </div>
        <div class="basis-2/12">
            <label for="">Học hàm</label>
            <ng-select
                [items]="listHocHam"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn học hàm"
                formControlName="hocHamDongChuNhiem" 
            >
            </ng-select>
        </div>
        <div class="basis-1/4">
            <label for="">Học vị</label>
            <ng-select
                [items]="listHocVi"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn học vị"
                formControlName="hocViDongChuNhiem" 
            >
            </ng-select>
        </div>
        <div class="basis-1/4">
            <label for="">Đơn vị công tác</label>
            <input   class="form-control" type="text" name="" id=""  formControlName="donViCongTacDongChuNhiem"  />
            <!-- <ng-select
                [items]="listDonViCongTac"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn đơn vị"
                formControlName="donViCongTacDongChuNhiem" 
            >
            </ng-select> -->
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-1/4">
            <label for="">Thư ký đề tài</label>
            <div class="select-cbkh flex items-center form-control">
                <input class="inputselect" type="text" name="" id="" formControlName="thuKyDeTai"  />
                <i (click)="openAlertDialog('THUKY')" class="fa fa-search"></i>
            </div>
        </div>
        <div class="basis-1/12">
            <label for="">Giới tính</label>
            <ng-select
                [items]="listGioiTinh"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn giới tính"
                formControlName="gioiTinhThuKy" 
            >
            </ng-select>
        </div>
        <div class="basis-2/12">
            <label for="">Học hàm</label>
            <ng-select
                [items]="listHocHam"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn học hàm"
                formControlName="hocHamThuKy" 
            >
            </ng-select>
        </div>
        <div class="basis-1/4">
            <label for="">Học vị</label>
            <ng-select
                [items]="listHocVi"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn học vị"
                formControlName="hocViThuKy" 
            >
            </ng-select>
        </div>
        <div class="basis-1/4">
            <label for="">Đơn vị công tác</label>
            <input   class="form-control" type="text" name="" id=""  formControlName="donViCongTacThuKy"  />
            <!-- <ng-select
                [items]="listDonViCongTac"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn đơn vị"
                formControlName="donViCongTacThuKy" 
            >
            </ng-select> -->
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-full">
            <label for="">Thành viên tham gia</label>
            <table class="table table_custom" style="margin-top: 3px">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Họ và tên</th>
                        <th>Chức danh thực hiện đề tài</th>
                        <th>Số điện thoại</th>
                        <th>Email</th>
                        <th>Đơn vị công tác</th>
                        <th><button class="pull-right add_button" (click)="addThanhVien()">+Thêm thành viên</button></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let thanhvien of $any(form.get('danhSachThanhVien')).controls;let i = index" [formGroup]="thanhvien">
                        <td class="stt_table">{{i+1}}</td>
                        <td>
                            <div class="select-cbkh flex items-center form-control">
                                <input class="inputselect" type="text" name="" id="" formControlName="ten"  />
                                <i (click)="openAlertDialog('THANHVIEN',thanhvien)" class="fa fa-search"></i>
                            </div>
                            <!-- <input style="border:1px solid #ccc; border-radius: 5px;" type="text" name="" formControlName="ten" id=""> <i (click)="openAlertDialog('THANHVIEN',thanhvien.get('ten'))" class="fa fa-search"></i> -->
                        </td>
                        <td>  <ng-select
                            [items]="listChucDanh"
                            bindLabel="NAME"
                            bindValue="ID"
                            placeholder="Chọn chức"
                            formControlName="chucDanh" 
                        >
                        </ng-select></td>
                        <!-- {{thanhvien.get('chucDanh').value}} -->
                        <td><input  style="border:1px solid #ccc; border-radius: 5px;width: 100%; height: 30px;"  class="inputselect" type="text" name="" id="" formControlName="soDienThoai"  /></td>
                        <td><input  style="border:1px solid #ccc; border-radius: 5px;width: 100%; height: 30px;"  class="inputselect" type="text" name="" id="" formControlName="email"  /></td>
                        <td><input  style="border:1px solid #ccc; border-radius: 5px;width: 100%; height: 30px;"  class="inputselect" type="text" name="" id="" formControlName="donViCongTac"  /></td>
                        <td  class="text-center action-table"> <i (click)="removeItem(form,i)" class="fa fa-trash"
                            title="Xóa bỏ"></i></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="title-section kinhphi">
        <i class="fa fa-minus-circle"></i> Kinh phí:
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-1/5">
            <label for="">Nguồn kinh phí<span>(*)</span></label>
            <ng-select
                [items]="listNguonKinhPhi"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Nguồn kinh phí"
                formControlName="nguonKinhPhi" 
            >
            </ng-select>
        </div>
        <div class="basis-1/5">
            <label for="">Tổng kinh phí</label>
            <input
                class="form-control"
                placeholder="VNĐ"
                formControlName="tongKinhPhi" 
                type="text"
                name=""
                id=""
            />
        </div>
        <div class="basis-1/5">
            <label for="">Phương thức khoán chi</label>
            <ng-select
                [items]="listKhoanChi"
                bindLabel="NAME"
                bindValue="ID"
                placeholder="Chọn phương thức"
                formControlName="phuongThucKhoanChi" 
            >
            </ng-select>
        </div>
        <div class="basis-1/5">
            <label for="">Khinh phí khoán</label>
            <input
                class="form-control"
                placeholder="VNĐ"
                type="text"
                name=""
                formControlName="kinhPhiKhoan" 
                id=""
            />
        </div>
        <div class="basis-1/5">
            <label for="">Khinh phí không khoán</label>
            <input
                class="form-control"
                placeholder="VNĐ"
                type="text"
                name=""
                formControlName="kinhPhiKhongKhoan" 
                id=""
            />
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-full">
            <label for="">Tính cấp thiết của đề tài, nhiệm vụ KHCN</label>
            <textarea
                name=""
                id=""
                formControlName="tinhCapThietCuaDeTaiNhiemVu" 
                class="form-control p-3 min-h-30"
            ></textarea>
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-full">
            <label for="">Mục tiêu</label>
            <textarea
            formControlName="mucTieu" 
                name=""
                id=""
                class="form-control p-3 min-h-30"
            ></textarea>
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-full">
            <label for="">Nhiệm vụ và phạm vi nghiên cứu, thực hiện</label>
            <textarea
                name=""
                formControlName="nhiemVuVaPhamViNghienCuu" 
                id=""
                class="form-control p-3 min-h-30"
            ></textarea>
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-full">
            <label for="">Kết quả dự kiến</label>
            <textarea
            formControlName="ketQuaDuKien" 
                name=""
                id=""
                class="form-control p-3 min-h-30"
            ></textarea>
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-full">
            <label for="">Kiến nghị, đề xuất</label>
            <textarea
            formControlName="kienNghiDeXuat" 
                name=""
                id=""
                class="form-control p-3 min-h-30"
            ></textarea>
        </div>
    </div>

    <div class="title-section">
        <i class="fa fa-minus-circle"></i> Hồ sơ thuyết minh
    </div>

    <div class="flex flex-row row gap-4">
        <div class="basis-full">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên hồ sơ</th>
                        <th>Danh sách File</th>
                        <th>File đính kèm</th>
                    </tr>
                </thead>
                <tbody formArrayName="listFolderFile">
                    <ng-container *ngFor="let item of form.get('listFolderFile')['controls']; let i = index">
                    <tr   [formGroupName]="i" >
                        <td class="stt_table">{{i+1}}</td>
                        <td>{{item.get('fileName').value}}</td>
                        <td >
                            <div class="list-file" *ngIf="item.get('listFile').value.length > 0">
                                <table class="table table_custom action-table">
                                    <thead>
                                        <tr> 
                                            <th class="stt_table">STT</th>
                                            <th>Tên file</th>
                                            <th class="text-center">Kích thước
                                            </th>
                                            <th class="text-center">Số văn bản
                                            </th>
                                            <th style="width: 100px;"></th>
                                        </tr>
                                    </thead>
                                    <tbody formArrayName="listFile">
                                        <ng-container *ngFor="let item2 of item.get('listFile')['controls']; let k = index">
                                        <tr  [formGroupName]="k">
                                            <td class="stt_table">{{k+1}}</td>
                                            <td>{{item2.get('fileName').value}}</td>
                                            <td>
                                                {{item2.get('size').value >(1024 * 1024)?(item2.get('size').value/(1024*1024)).toFixed(1)+'(MB)':item2.get('size').value >1024?(item2.get('size').value/(1024)).toFixed(1)+'(KB)':item2.get('size').value.toFixed(1) +"K"}}</td>
                                            
                                             <td>{{item2.get('sovanban').value}}</td>
                                            <td class="text-center">  <i style="color: red; cursor: pointer;    margin-right: 10px;" (click)="deleteItemFile(item,k)" class="fa fa-trash" title="Xóa bỏ"></i>
                                                <i class="fa fa-cloud-download" style="color: green; cursor: pointer;" aria-hidden="true" (click)="downLoadFile(item2)" title="Download file"></i>
                                            </td>  
                            
                                        </tr>
                                    </ng-container>
                            
                                    </tbody>
                                </table>
                            </div> 
                        </td>
                        <td class="text-center">
                            <label class="custom-file-upload add_button-import">
                                <input type="file" multiple  (change)="handleUpload($event,item,i)" #fileUpload2/>
                                <i class="fa fa-cloud-upload"></i> Upload file
                            </label>
                            <!-- <button class="add_button">
                                <i class="fa fa-link"></i> Upload file
                            </button> -->
                        </td>
                    </tr>
                </ng-container>
                </tbody>
            </table>
        </div>
    </div>
    <div class="action-all-f">
        <button class="add_button" (click)="onSubmit('LUU','CAPNHAT')"><i class="fa fa-save"></i> Lưu</button>
        <button class="add_button">
            <i class="fa fa-save"></i> Lưu và gửi
        </button>
    </div>
</div>
<!--chi tiết-->
<div *ngIf="actionType == 'CHITIET'"
    class="flex flex-col flex-auto overflow-y-auto bg-card dark:bg-default content-detail p-3"
    [formGroup]="form" 
>
    <div class="">
        <h1 class="title-component">Chi tiết thông tin đề tài, nhiệm vụ</h1>
    </div>

    <mat-tab-group class="detail_tab1">
        <mat-tab label="Thông tin đề tài">
            <table class="table table_custom" style="margin-top: 0">
                <tbody>
                    <tr>
                        <td>Tên đề tài</td>
                        <td style="font-weight: 600; color: #2a3493">
                            Ứng dụng chuyển đổi số trong Hóa đơn điện tử
                        </td>
                    </tr>
                    <tr>
                        <td>Cấp quản lý</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Lĩnh vực nghiên cứu</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Đơn vị chủ trì</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Thời gian thực hiện</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Chủ nhiệm đề tài</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Đơn vị công tác</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Đồng chủ nhiệm đề tài</td>
                        <td>Thư ký đề tài</td>
                    </tr>
                    <tr>
                        <td>Tình trạng đề tài</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Kinh phí thực hiện</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Nguồn kinh phí</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Mục tiêu</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Tính cấp thiết của nhiệm vụ KHCN</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Nhiệm vụ và phạm vi nghiên cứu, thực hiện</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Kết quả dự kiến</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Kiến nghị, đề xuất</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                    <tr>
                        <td>Số lần gia hạn</td>
                        <td>ỨCấp EVN</td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
        <mat-tab label="Thành viên tham gia">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Họ và tên</th>
                        <th>Chức vụ</th>
                        <th>Số điện thoại</th>
                        <th>Email</th>
                        <th>Công việc tham gia</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
        <mat-tab label="Tiến độ thực hiện">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">Tháng/năm</th>
                        <th>Nội dung báo cáo công việc</th>
                        <th>Kế hoạch thực hiện tiếp theo</th>
                        <th>Đề xuất/ Kiến nghị</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1/2022</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
        <mat-tab label="Hội đồng xét duyệt/ tuyển chọn">
            <div class="flex flex-row row gap-4">
                <div class="basis-1/12">
                    <label for="">Tên đề tài/ nhiệm vụ:</label>
                </div>
                <div class="basis-2/5">
                    <span
                        >Nghiên cứu công nghệ chuyển đổi sổ áp dụng mã vạch
                        trong quản lý VTTB</span
                    >
                </div>
                <div class="basis-1/12">
                    <label for="">Cấp độ ĐT/NV:</label>
                </div>
                <div class="basis-1/5">
                    <span>Cấp EVN</span>
                </div>
            </div>
            <div class="flex flex-row row gap-4">
                <div class="basis-1/12">
                    <label for="">Chủ nhiệm:</label>
                </div>
                <div class="basis-2/5">
                    <span>Nguyễn Văn A</span>
                </div>
                <div class="basis-1/12">
                    <label for="">Đơn vị công tác:</label>
                </div>
                <div class="basis-1/5">
                    <span>Ban KHCNMT</span>
                </div>
            </div>
            <label class="tiite_lale" for=""
                >Danh sách các văn bản liên quan</label
            >
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên văn bản</th>
                        <th>Số ký hiệu</th>
                        <th>Ngày văn bản</th>
                        <th>File nội dung</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>
                            <button class="dowwnload" style="color: #2a3493">
                                <i class="fa fa-cloud-download"></i> Tải về
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>

            <label
                class="tiite_lale"
                style="margin-top: 20px; display: block"
                for=""
                >Thành viên hội đồng</label
            >
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Thành viên hội đồng</th>
                        <th>Vai trò</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>
            <label
                class="tiite_lale"
                style="margin-top: 20px; display: block"
                for=""
                >Kết luận, kiến nghị của Hội đồng<label
                    style="font-style: italic"
                    >(kiến nghị về các nội dung cần sửa đổi)</label
                ></label
            >
            <div class="flex flex-row row gap-4">
                <div class="basis-1/6">
                    <label for=""
                        >Biên bản họp hội đồng xét duyệt, tuyển chọn</label
                    >
                </div>
                <div class="basis-1/5">
                    <button class="dowwnload" style="color: #2a3493">
                        <i class="fa fa-cloud-download"></i> Tải về
                    </button>
                </div>
            </div>
            <div class="flex flex-row row gap-4">
                <div class="basis-1/6">
                    <label for="">Phiếu đánh giá và tài liệu khác</label>
                </div>
                <div class="basis-1/5">
                    <button class="dowwnload" style="color: #2a3493">
                        <i class="fa fa-cloud-download"></i> Tải về
                    </button>
                </div>
            </div>
        </mat-tab>
        <mat-tab label="Hội đồng xét duyệt/ tuyển chọn">
            <div class="flex flex-row row gap-4">
                <div class="basis-1/12">
                    <label for="">Tên đề tài/ nhiệm vụ:</label>
                </div>
                <div class="basis-2/5">
                    <span
                        >Nghiên cứu công nghệ chuyển đổi sổ áp dụng mã vạch
                        trong quản lý VTTB</span
                    >
                </div>
                <div class="basis-1/12">
                    <label for="">Cấp độ ĐT/NV:</label>
                </div>
                <div class="basis-1/5">
                    <span>Cấp EVN</span>
                </div>
            </div>
            <div class="flex flex-row row gap-4">
                <div class="basis-1/12">
                    <label for="">Chủ nhiệm:</label>
                </div>
                <div class="basis-2/5">
                    <span>Nguyễn Văn A</span>
                </div>
                <div class="basis-1/12">
                    <label for="">Đơn vị công tác:</label>
                </div>
                <div class="basis-1/5">
                    <span>Ban KHCNMT</span>
                </div>
            </div>
            <label class="tiite_lale" for=""
                >Danh sách các văn bản liên quan</label
            >
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên văn bản</th>
                        <th>Số ký hiệu</th>
                        <th>Ngày văn bản</th>
                        <th>File nội dung</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>
                            <button class="dowwnload" style="color: #2a3493">
                                <i class="fa fa-cloud-download"></i> Tải về
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>

            <label
                class="tiite_lale"
                style="margin-top: 20px; display: block"
                for=""
                >Thành viên hội đồng</label>
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Thành viên hội đồng</th>
                        <th>Vai trò</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>

            <div class="flex flex-row row gap-4">
                <div class="basis-1/5">
                    <label for="">Kết quả đánh giá</label>
                    <ng-select
                        [items]="listYears"
                        bindLabel="NAME"
                        bindValue="ID"
                        placeholder="Chọn kết quả"
                        [(ngModel)]="selectedYear"
                    >
                    </ng-select>
                </div>
                <div class="basis-1/5">
                    <label for="">Điểm đánh giá</label>
                    <input
                        class="form-control"
                        type="text"
                        name=""
                        id=""
                    />
                </div>
                </div>

                <div class="flex flex-row row gap-4">
                    <div class="basis-full">
                        <label for="">Kết quả thực tế đạt được của đề tài</label>
                        <textarea
                            name=""
                            id=""
                            class="form-control p-3 min-h-30"
                        ></textarea>
                    </div>
                </div>
                <div class="flex flex-row row gap-4">
                    <div class="basis-full">
                        <label for=""> Các tồn tại và đề xuất hướng/biện pháp giải quyết</label>
                        <textarea
                            name=""
                            id=""
                            class="form-control p-3 min-h-30"
                        ></textarea>
                    </div>
                </div>


            <label
                class="tiite_lale"
                style="margin-top: 20px; display: block"
                for=""
                >Kết luận, kiến nghị của Hội đồng<label
                    style="font-style: italic"
                    >(kiến nghị về các nội dung cần sửa đổi)</label
                ></label
            >
            <div class="flex flex-row row gap-4">
                <div class="basis-1/6">
                    <label for=""
                        >Biên bản họp hội đồng xét duyệt, tuyển chọn</label
                    >
                </div>
                <div class="basis-1/5">
                    <button class="dowwnload" style="color: #2a3493">
                        <i class="fa fa-cloud-download"></i> Tải về
                    </button>
                </div>
            </div>
            <div class="flex flex-row row gap-4">
                <div class="basis-1/6">
                    <label for="">Phiếu đánh giá và tài liệu khác</label>
                </div>
                <div class="basis-1/5">
                    <button class="dowwnload" style="color: #2a3493">
                        <i class="fa fa-cloud-download"></i> Tải về
                    </button>
                </div>
            </div>
        </mat-tab>
    </mat-tab-group>

    <div class="">
        <h1 class="title-component">Tài liệu đính kèm của đề tài, nhiệm vụ</h1>
    </div>

    <mat-tab-group class="detail_tab1">
        <mat-tab label="Hồ sơ đăng ký">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên hồ sơ</th>
                        <th>Người cập nhập</th>
                        <th>Ngày cập nhập</th>
                        <th>File đính kèm</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td> 
                            <button class="dowwnload" style="color: #2a3493">
                            <i class="fa fa-cloud-download"></i> Tải về
                        </button></td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
        <mat-tab label="Hồ sơ xét duyệt, giao, ký hợp đồng thực hiện">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên hồ sơ</th>
                        <th>Người cập nhập</th>
                        <th>Ngày cập nhập</th>
                        <th>File đính kèm</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td> 
                            <button class="dowwnload" style="color: #2a3493">
                            <i class="fa fa-cloud-download"></i> Tải về
                        </button></td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
        <mat-tab label="Hồ sơ đề nghị tạm ứng kinh phí các đợt sau">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên hồ sơ</th>
                        <th>Người cập nhập</th>
                        <th>Ngày cập nhập</th>
                        <th>File đính kèm</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td> 
                            <button class="dowwnload" style="color: #2a3493">
                            <i class="fa fa-cloud-download"></i> Tải về
                        </button></td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
        <mat-tab label="Hồ sơ nghiệm thu">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên hồ sơ</th>
                        <th>Người cập nhập</th>
                        <th>Ngày cập nhập</th>
                        <th>File đính kèm</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td> 
                            <button class="dowwnload" style="color: #2a3493">
                            <i class="fa fa-cloud-download"></i> Tải về
                        </button></td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
        <mat-tab label="Bàn giao, lưu trữ kết quả thực hiện">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên hồ sơ</th>
                        <th>Người cập nhập</th>
                        <th>Ngày cập nhập</th>
                        <th>File đính kèm</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td> 
                            <button class="dowwnload" style="color: #2a3493">
                            <i class="fa fa-cloud-download"></i> Tải về
                        </button></td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
        <mat-tab label="Hồ sơ thanh quyết toán">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên hồ sơ</th>
                        <th>Người cập nhập</th>
                        <th>Ngày cập nhập</th>
                        <th>File đính kèm</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td> 
                            <button class="dowwnload" style="color: #2a3493">
                            <i class="fa fa-cloud-download"></i> Tải về
                        </button></td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
    </mat-tab-group>
</div>
<!--LICH SU-->
<div *ngIf="actionType == 'LICHSU'"
    class="flex flex-col flex-auto overflow-y-auto bg-card dark:bg-default content-detail p-3"
    [formGroup]="form" 
>
<app-lichsu></app-lichsu>
</div>

<!--TIENDO-->
<div *ngIf="actionType == 'TIENDO'"
    class="flex flex-col flex-auto overflow-y-auto bg-card dark:bg-default content-detail p-3"
    [formGroup]="form" 
>
<div class="">
    <h1 class="title-component">Báo cáo tiến độ thực hiện định kỳ</h1>
</div> 

<div class="flex flex-row row gap-4">
   
    <div class="basis-1/2">
        <label for="">Tháng
        </label>
        <ng-select
        [items]="listThang"
        bindLabel="NAME"
        bindValue="ID"
        placeholder="Lựa chọn"
        formControlName="thang" 
        style="width: 100%"
    >
    </ng-select>
    </div>
    <div class="basis-1/2">
        <label for="">Năm
        </label>
        <ng-select
        [items]="listNam"
        bindLabel="NAME"
        bindValue="ID"
        placeholder="Lựa chọn"
        formControlName="nam" 
        style="width: 100%"
    >
    </ng-select>
    </div>
    </div>

    <label class="title_labe" for="">Nội dung báo cáo</label>
    <textarea class="form-control"  formControlName="noiDung"  name="" id="" cols="30" rows="10" style="padding: 10px; min-height: 100px;"></textarea>


    <label class="title_labe" for="">Kế hoạch thực hiện tiếp theo</label>
    <textarea class="form-control" name="" formControlName="keHoachTiepTheo" id="" cols="30" rows="10" style="padding: 10px; min-height: 100px;"></textarea>

    <label class="title_labe" for="">Đề xuất/ Kiến nghị</label>
    <textarea class="form-control" name="" id="" formControlName="dexuatKienNghi" cols="30" rows="10" style="padding: 10px; min-height: 100px;"></textarea>

    <div class="action-all-f">
        <button class="add_button" (click)="onSubmit('LUU','BAOCAOTIENDO')"><i class="fa fa-save"></i> Lưu</button>
    </div>

</div>

<div
    *ngIf="actionType == 'updateActionHSTH'"
    class="flex flex-col flex-auto overflow-y-auto bg-card dark:bg-default content-detail p-3"
    [formGroup]="form" 
>
    <div class="">
        <h1 class="title-component">
            CẬP NHẬP HỒ SƠ THỰC HIỆN
        </h1>
        <div class="title-section">
            <i class="fa fa-minus-circle"></i> Thông tin đề tài:
        </div>
    </div>


    <div class="flex flex-row row gap-4"> 
        <div class="basis-1/12">
            <label for="">Tên đề tài/ nhiệm vụ:</label>
        </div>
        <div class="basis-2/5">
            <span
                >{{form.get('tenDeTai').value}}</span
            >
        </div>
        <div class="basis-1/12">
            <label for="">Cấp độ ĐT/NV:</label>
        </div>
        <div class="basis-1/5">
            <span>{{form.get('tenCapQuanLy').value}}</span>
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-1/12">
            <label for="">Chủ nhiệm:</label>
        </div>
        <div class="basis-2/5">
            <span>{{form.get('chuNhiemDeTai').value}}</span>
        </div>
        <div class="basis-1/12">
            <label for="">Đơn vị công tác:</label>
        </div>
        <div class="basis-1/5">
            <span>{{form.get('donViCongTac').value}}</span>
        </div>
    </div>
    <div class="title-section">
        <i class="fa fa-minus-circle"></i>Hồ sơ thực hiện:
    </div>
    <mat-tab-group class="detail_tab1" style="margin-top: 10px;">
        <mat-tab label="Xét duyệt, giao, ký hợp đồng thực hiện">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên hồ sơ</th>
                        <th>Người cập nhập</th>
                        <th>Ngày cập nhập</th>
                        <th>File đính kèm</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody formArrayName="listFolderFileThucHien">
                    <tr *ngFor="let item of form.get('listFolderFileThucHien')['controls']; let i = index">
                        <td class="stt_table">{{i+1}}</td>
                        <td>{{item.get('fileName').value}}</td>
                        <td>{{item.get('fileName').value}}</td>
                        <td>{{item.get('fileName').value}}</td>
                        <td>
                            <div class="list-file" *ngIf="item.get('listFile').value.length >0">
                                <table class="table table_custom action-table">
                                    <thead>
                                        <tr> 
                                            <th class="stt_table">STT</th>
                                            <th>Tên file</th>
                                            <th class="text-center">Kích thước
                                            </th>
                                            <th class="text-center">Số văn bản
                                            </th>
                                            <th style="width: 100px;"></th>
                                        </tr>
                                    </thead>
                                    <tbody formArrayName="listFile">
                                     
                                        <tr *ngFor="let item2 of item.get('listFile')['controls']; let k = index">
                                            <td class="stt_table">{{k+1}}</td>
                                            <td>{{item2.get('fileName').value}}</td>
                                            <td>
                                                {{item2.get('size').value >(1024 * 1024)?(item2.get('size').value/(1024*1024)).toFixed(1)+'(MB)':item2.get('size').value >1024?(item2.get('size').value/(1024)).toFixed(1)+'(KB)':item2.get('size').value.toFixed(1) +"K"}}</td>
                                            
                                             <td>{{item2.get('sovanban').value}}</td>
                                            <td class="text-center">  <i style="color: red; cursor: pointer;    margin-right: 10px;" (click)="deleteItemFile(item,k)" class="fa fa-trash" title="Xóa bỏ"></i>
                                                <i class="fa fa-cloud-download" style="color: green; cursor: pointer;" aria-hidden="true" (click)="downLoadFile(item2)" title="Download file"></i>
                                            </td>  
                            
                                        </tr>
                            
                                    </tbody>
                                </table>
                            </div> 
                        </td>
                        <td class="text-center">
                            <label class="custom-file-upload add_button-import">
                                <input type="file" multiple  (change)="handleUpload($event,item,i)" #fileUpload2/>
                                <i class="fa fa-cloud-upload"></i> Upload file
                            </label>
                            <!-- <button class="add_button">
                                <i class="fa fa-link"></i> Upload file
                            </button> -->
                        </td>
                        <td class="text-center">
                           
                        </td>
                    </tr>
                </tbody>
                <!-- <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td> 
                            <button class="dowwnload px-10 py-2 rounded-md bg-sky-500 text-white">
                                <i class="fa fa-cloud-upload"></i> Upload</button>
                            </td>
                        <td>Noi dung</td>
                    </tr>
                </tbody> -->
            </table>
        </mat-tab>
        <mat-tab label="Hồ sơ đề nghị tạm ứng kinh phí các đợt sau">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên hồ sơ</th>
                        <th>Người cập nhập</th>
                        <th>Ngày cập nhập</th>
                        <th>File đính kèm</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody formArrayName="listFolderFileTamUng">
                    <tr *ngFor="let item of form.get('listFolderFileTamUng')['controls']; let i = index">
                        <td class="stt_table">{{i+1}}</td>
                        <td>{{item.get('fileName').value}}</td>
                        <td>{{item.get('fileName').value}}</td>
                        <td>{{item.get('fileName').value}}</td>
                        <td>
                            <div class="list-file" *ngIf="item.get('listFile').value.length >0">
                                <table class="table table_custom action-table">
                                    <thead>
                                        <tr> 
                                            <th class="stt_table">STT</th>
                                            <th>Tên file</th>
                                            <th class="text-center">Kích thước
                                            </th>
                                            <th class="text-center">Số văn bản
                                            </th>
                                            <th style="width: 100px;"></th>
                                        </tr>
                                    </thead>
                                    <tbody formArrayName="listFile">
                                     
                                        <tr *ngFor="let item2 of item.get('listFile')['controls']; let k = index">
                                            <td class="stt_table">{{k+1}}</td>
                                            <td>{{item2.get('fileName').value}}</td>
                                            <td>
                                                {{item2.get('size').value >(1024 * 1024)?(item2.get('size').value/(1024*1024)).toFixed(1)+'(MB)':item2.get('size').value >1024?(item2.get('size').value/(1024)).toFixed(1)+'(KB)':item2.get('size').value.toFixed(1) +"K"}}</td>
                                            
                                             <td>{{item2.get('sovanban').value}}</td>
                                            <td class="text-center">  <i style="color: red; cursor: pointer;    margin-right: 10px;" (click)="deleteItemFile(item,k)" class="fa fa-trash" title="Xóa bỏ"></i>
                                                <i class="fa fa-cloud-download" style="color: green; cursor: pointer;" aria-hidden="true" (click)="downLoadFile(item2)" title="Download file"></i>
                                            </td>  
                            
                                        </tr>
                            
                                    </tbody>
                                </table>
                            </div> 
                        </td>
                        <td class="text-center">
                            <label class="custom-file-upload add_button-import">
                                <input type="file" multiple  (change)="handleUploadTamUng($event,item,i)" #fileUpload2/>
                                <i class="fa fa-cloud-upload"></i> Upload file
                            </label>
                            <!-- <button class="add_button">
                                <i class="fa fa-link"></i> Upload file
                            </button> -->
                        </td>
                        <td class="text-center">
                           
                        </td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
    </mat-tab-group>


    <div style="display: flex; margin-top: 10px; align-items: center">
        <label for="" style="margin-right: 10px">Trạng thái <span>(*)</span></label>
        <ng-select
            [items]="listTrangThai"
            bindLabel="NAME"
            bindValue="ID"
            placeholder="Lựa chọn"
            formControlName="maTrangThai" 
            style="width: 200px"
        >
        </ng-select>
    </div>

    <div class="flex items-center" style="margin-bottom: 10px; margin-top: 10px;">
        <input  type="checkbox" formControlName="isEmail" [checked]="form.get('isEmail').value" class="mr-1" />
        <span style="margin-left: 5px;"> Gửi email thông báo đến chủ nhiệm và các bên liên quan</span>
    </div>

    <label class="title_labe" for="">Nội dung gửi mail</label>
    <textarea class="form-control" name="" formControlName="noiDungGuiMail" id="" cols="30" rows="10" style="padding: 10px; min-height: 100px;"></textarea>

    <div class="action-all-f">
        <button class="add_button" (click)="onSubmit('LUU','CAPNHATHSTHUCHIEN')"><i class="fa fa-save"></i> Lưu</button>
    </div>
</div>

<div
    *ngIf="actionType == 'updateActionHSNT'"
    class="flex flex-col flex-auto overflow-y-auto bg-card dark:bg-default content-detail p-3"
    [formGroup]="form" 
>
    <div class="">
        <h1 class="title-component">
            CẬP NHẬP HỒ SƠ NGHIỆM THU
        </h1>
        <div class="title-section">
            <i class="fa fa-minus-circle"></i> Thông tin đề tài:
        </div>
    </div>


    <div class="flex flex-row row gap-4"> 
        <div class="basis-1/12">
            <label for="">Tên đề tài/ nhiệm vụ:</label>
        </div>
        <div class="basis-2/5">
            <span
                >Nghiên cứu công nghệ chuyển đổi sổ áp dụng mã vạch trong quản
                lý VTTB</span
            >
        </div>
        <div class="basis-1/12">
            <label for="">Cấp độ ĐT/NV:</label>
        </div>
        <div class="basis-1/5">
            <span>Cấp EVN</span>
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-1/12">
            <label for="">Chủ nhiệm:</label>
        </div>
        <div class="basis-2/5">
            <span>Nguyễn Văn A</span>
        </div>
        <div class="basis-1/12">
            <label for="">Đơn vị công tác:</label>
        </div>
        <div class="basis-1/5">
            <span>Ban KHCNMT</span>
        </div>
    </div>
    <div class="title-section">
        <i class="fa fa-minus-circle"></i>Hồ sơ thực hiện:
    </div>
    <mat-tab-group class="detail_tab1" style="margin-top: 10px;">
        <mat-tab label="Hồ sơ nghiệm thu">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên hồ sơ</th>
                        <th>Người cập nhập</th>
                        <th>Ngày cập nhập</th>
                        <th>File đính kèm</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td> 
                            <button class="dowwnload px-10 py-2 rounded-md bg-sky-500 text-white">
                                <i class="fa fa-cloud-upload"></i> Upload</button>
                            </td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
        <mat-tab label="Bàn giao, lưu trữ kết quả thực hiện">
            <table class="table table_custom" style="margin-top: 0">
                <thead>
                    <tr>
                        <th class="stt_table">STT</th>
                        <th>Tên hồ sơ</th>
                        <th>Người cập nhập</th>
                        <th>Ngày cập nhập</th>
                        <th>File đính kèm</th>
                        <th>Ghi chú</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="stt_table">1</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td>Noi dung</td>
                        <td> 
                            <button class="dowwnload px-10 py-2 rounded-md bg-sky-500 text-white">
                            <i class="fa fa-cloud-upload"></i> Upload
                        </button></td>
                        <td>Noi dung</td>
                    </tr>
                </tbody>
            </table>
        </mat-tab>
    </mat-tab-group>


    <div style="display: flex; margin-top: 10px; align-items: center">
        <label for="" style="margin-right: 10px">Trạng thái <span>(*)</span></label>
        <ng-select
            [items]="listYears"
            bindLabel="NAME"
            bindValue="ID"
            placeholder="Lựa chọn"
            [(ngModel)]="selectedYear"
            style="width: 200px"
        >
        </ng-select>
    </div>

    <div class="flex items-center" style="margin-bottom: 10px; margin-top: 10px;">
        <input type="checkbox" name="" id="">
        <span style="margin-left: 5px;"> Gửi email thông báo đến chủ nhiệm và các bên liên quan</span>
    </div>

    <label class="title_labe" for="">Nội dung gửi mail</label>
    <textarea class="form-control" name="" id="" cols="30" rows="10" style="padding: 10px; min-height: 100px;"></textarea>

    <div class="action-all-f">
        <button class="add_button"><i class="fa fa-save"></i> Lưu</button>
    </div>
</div>


<div
    *ngIf="actionType == 'updateActionHSQT'"
    class="flex flex-col flex-auto overflow-y-auto bg-card dark:bg-default content-detail p-3"
    [formGroup]="form" 
>
    <div class="">
        <h1 class="title-component">
            CẬP NHẬP HỒ SƠ THANH QUYẾT TOÁN
        </h1>
        <div class="title-section">
            <i class="fa fa-minus-circle"></i> Thông tin đề tài:
        </div>
    </div>


    <div class="flex flex-row row gap-4"> 
        <div class="basis-1/12">
            <label for="">Tên đề tài/ nhiệm vụ:</label>
        </div>
        <div class="basis-2/5">
            <span
                >{{form.get('tenDeTai').value}}</span
            >
        </div>
        <div class="basis-1/12">
            <label for="">Cấp độ ĐT/NV:</label>
        </div>
        <div class="basis-1/5">
            <span>{{form.get('tenCapQuanLy').value}}</span>
        </div>
    </div>
    <div class="flex flex-row row gap-4">
        <div class="basis-1/12">
            <label for="">Chủ nhiệm:</label>
        </div>
        <div class="basis-2/5">
            <span>{{form.get('chuNhiemDeTai').value}}</span>
        </div>
        <div class="basis-1/12">
            <label for="">Đơn vị công tác:</label>
        </div>
        <div class="basis-1/5">
            <span>{{form.get('donViCongTac').value}}</span>
        </div>
    </div>
    <div class="title-section">
        <i class="fa fa-minus-circle"></i>Hồ sơ thực hiện:
    </div>
  
    <table class="table table_custom" style="margin-top: 0">
        <thead>
            <tr>
                <th class="stt_table">STT</th>
                <th>Tên hồ sơ</th>
                <th>Người cập nhập</th>
                <th>Ngày cập nhập</th>
                <th>File đính kèm</th>
                <th>Ghi chú</th>
            </tr>
        </thead>
        <tbody formArrayName="listFolderFile">
            <tr *ngFor="let item of form.get('listFolderFile')['controls']; let i = index">
                <td class="stt_table">{{i+1}}</td>
                <td>{{item.get('fileName').value}}</td>
                <td >
                    <div class="list-file" *ngIf="item.get('listFile').value.length >0">
                        <table class="table table_custom action-table">
                            <thead>
                                <tr> 
                                    <th class="stt_table">STT</th>
                                    <th>Tên file</th>
                                    <th class="text-center">Kích thước
                                    </th>
                                    <th class="text-center">Số văn bản
                                    </th>
                                    <th style="width: 100px;"></th>
                                </tr>
                            </thead>
                            <tbody formArrayName="listFile">
                             

                                <tr *ngFor="let item2 of item.get('listFile')['controls']; let k = index">
                                    <td class="stt_table">{{k+1}}</td>
                                    <td>{{item2.get('fileName').value}}</td>
                                    <td>
                                        {{item2.get('size').value >(1024 * 1024)?(item2.get('size').value/(1024*1024)).toFixed(1)+'(MB)':item2.get('size').value >1024?(item2.get('size').value/(1024)).toFixed(1)+'(KB)':item2.get('size').value.toFixed(1) +"K"}}</td>
                                    
                                     <td>{{item2.get('sovanban').value}}</td>
                                    <td class="text-center">  <i style="color: red; cursor: pointer;    margin-right: 10px;" (click)="deleteItemFile(item,k)" class="fa fa-trash" title="Xóa bỏ"></i>
                                        <i class="fa fa-cloud-download" style="color: green; cursor: pointer;" aria-hidden="true" (click)="downLoadFile(item2)" title="Download file"></i>
                                    </td>  
                    
                                </tr>
                    
                            </tbody>
                        </table>
                    </div> 
                </td>
                <td class="text-center">
                    <label class="custom-file-upload add_button-import">
                        <input type="file" multiple  (change)="handleUpload($event,item,i)" #fileUpload2/>
                        <i class="fa fa-cloud-upload"></i> Upload file
                    </label>
                    <!-- <button class="add_button">
                        <i class="fa fa-link"></i> Upload file
                    </button> -->
                </td>
            </tr>
        </tbody>
        <!-- <tbody>
            <tr>
                <td class="stt_table">1</td>
                <td>Noi dung</td>
                <td>Noi dung</td>
                <td>Noi dung</td>
                <td> 
                    <button class="dowwnload px-10 py-2 rounded-md bg-sky-500 text-white">
                        <i class="fa fa-cloud-upload"></i> Upload</button>
                    </td>
                <td>Noi dung</td>
            </tr>
        </tbody> -->
    </table>


    <div style="display: flex; margin-top: 10px; align-items: center">
        <label for="" style="margin-right: 10px">Trạng thái <span>(*)</span></label>
        <ng-select
            [items]="listTrangThai"
            bindLabel="NAME"
            bindValue="ID"
            placeholder="Lựa chọn"
            formControlName="maTrangThai" 
            style="width: 200px"
        >
        </ng-select>
    </div>

    <div class="flex items-center" style="margin-bottom: 10px; margin-top: 10px;">
        <input  type="checkbox" formControlName="isEmail" [checked]="form.get('isEmail').value" class="mr-1" />
        <span style="margin-left: 5px;"> Gửi email thông báo đến chủ nhiệm và các bên liên quan</span>
    </div>

    <label class="title_labe" for="">Nội dung gửi mail</label>
    <textarea class="form-control" name="" formControlName="noiDungGuiMail" id="" cols="30" rows="10" style="padding: 10px; min-height: 100px;"></textarea>

    <div class="action-all-f">
        <button class="add_button" (click)="onSubmit('LUU','HSQTOAN')"><i class="fa fa-save"></i> Lưu</button>
    </div>
</div>